<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>LunexRub - Официальный сайт</title>
    <style>
        body { background: #313131; color: #AAAAAA; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; }
        .mc-header { background: #1e1e1e; width: 100%; padding: 20px; text-align: center; border-bottom: 4px solid #3c8527; color: #FFF; font-weight: bold; font-size: 24px; }
        .nav-bar { margin: 20px 0; display: flex; gap: 10px; }
        .nav-btn { background: #535353; border: 2px solid #000; color: white; padding: 10px 20px; cursor: pointer; box-shadow: inset -4px -4px 0px #222; font-weight: bold; position: relative; }
        .nav-btn:hover { background: #707070; }
        .container { background: #c6c6c6; border: 4px solid #000; color: #333; width: 80%; max-width: 650px; padding: 20px; box-shadow: inset -6px -6px 0px #555; text-align: center; }
        h2 { text-shadow: 1px 1px #000; color: #FFF; background: #555; padding: 10px; border: 2px solid #000; margin-top: 0; }
        input, textarea { width: 85%; padding: 12px; margin: 10px 0; border: 2px solid #000; background: #000; color: #3f3; font-family: monospace; font-size: 16px; }
        textarea { height: 100px; color: #fff; resize: none; }
        .mc-button { background: #3c8527; color: white; border: 2px solid #000; padding: 12px 30px; cursor: pointer; box-shadow: inset -4px -4px 0px #1a3911; font-weight: bold; }
        .rule-box { text-align: left; background: #a5a5a5; padding: 15px; border: 2px solid #000; height: 350px; overflow-y: scroll; font-size: 14px; color: #000; line-height: 1.5; }
        .hidden { display: none !important; }
        .req-card { border: 2px solid #000; background: #ddd; padding: 15px; margin-top: 15px; text-align: left; color: #000; }
        .alert-mark { background: red; color: white; border-radius: 50%; padding: 2px 8px; font-size: 14px; position: absolute; top: -10px; right: -10px; border: 2px solid white; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div class="mc-header">LUNEXRUB.RU</div>

<div class="nav-bar hidden" id="topNav">
    <button class="nav-btn" onclick="showSection('profileSec')">ПРОФИЛЬ</button>
    <button class="nav-btn" onclick="showSection('rulesSec')">ПРАВИЛА</button>
    <button id="adminNavBtn" class="nav-btn hidden" style="background:#800" onclick="showSection('adminSec')">
        ИГРОКИ <span id="adminAlert" class="alert-mark hidden">!</span>
    </button>
    <button class="nav-btn" style="background:#444" onclick="logout()">ВЫЙТИ</button>
</div>

<div id="loginSec" class="container">
    <h2>ВХОД / РЕГИСТРАЦИЯ</h2>
    <input type="text" id="username" placeholder="Ваш ник...">
    <input type="password" id="password" placeholder="Пароль">
    <p id="loginHint" style="font-size: 11px; color: #555;">Если вы впервые: введите ник и придумайте пароль.</p>
    <br><button class="mc-button" onclick="handleLogin()">ВОЙТИ НА СЕРВЕР</button>
</div>

<div id="profileSec" class="container hidden">
    <h2>МОЙ АККАУНТ</h2>
    <p>Ник: <b id="userLabel"></b> | Статус: <b style="color:black">Игрок</b></p>
    <hr>
    <div id="reqForm">
        <p>Связь с администрацией:</p>
        <textarea id="requestText" placeholder="Напишите ваш вопрос или заявку..."></textarea>
        <br><button class="mc-button" onclick="sendToAdmin()">ОТПРАВИТЬ</button>
    </div>
    <div id="reqOk" class="hidden">
        <b id="statusInfo">Ожидание ответа...</b>
        <br><br>
        <button class="mc-button" onclick="resetRequest()">НОВОЕ СООБЩЕНИЕ</button>
    </div>
</div>

<div id="adminSec" class="container hidden">
    <h2 style="background:#800">ПАНЕЛЬ УПРАВЛЕНИЯ (Jokeyu)</h2>
    <div id="requestList">Заявок нет</div>
</div>

<div id="rulesSec" class="container hidden">
    <h2>ПРАВИЛА И НАКАЗАНИЯ</h2>
    <div class="rule-box">
        <b>1. ОБЩЕЕ ПОВЕДЕНИЕ</b><br>
        1.1 Читы (Fly, X-Ray, KillAura и др.) — <b>Перманентный бан.</b><br>
        1.2 Гриферство (разрушение чужих баз) — <b>Бан 14-30 дней.</b><br>
        1.3 Использование багов игры — <b>Бан 7 дней.</b><br>
        1.4 Лаг-машины — <b>Перманентный бан.</b><br><br>
        
        <b>2. ЧАТ И ОБЩЕНИЕ</b><br>
        2.1 Оскорбление игроков — <b>Мут 1 час.</b><br>
        2.2 Оскорбление администрации — <b>Мут 5 часов или Бан 1 день.</b><br>
        2.3 Упоминание родных в оскорбительном ключе — <b>Перманентный бан.</b><br>
        2.4 Реклама других проектов — <b>Перманентный бан.</b><br>
        2.5 Спам / Капс / Флуд — <b>Мут 30 минут.</b><br><br>
        
        <b>3. ПРОЧЕЕ</b><br>
        3.1 Деструктивные действия для сервера — <b>Бан по IP.</b><br>
        3.2 Обман игроков при обмене — <b>Бан 3 дня.</b><br>
        3.3 Выпрашивание ресурсов у админов — <b>Кик / Мут 15 мин.</b>
    </div>
</div>

<script>
    const ADM_N = "Jokeyu";
    const ADM_P = "KeL_12Lek5Joke";
    
    let users = JSON.parse(localStorage.getItem('lunex_v60_pass')) || [];

    window.onload = function() {
        const loggedUser = sessionStorage.getItem('logged');
        const isAdmin = sessionStorage.getItem('isAdmin');
        if(loggedUser) {
            loginExecute(loggedUser, isAdmin === 'true');
        }
    };

    function handleLogin() {
        const n = document.getElementById('username').value.trim();
        const p = document.getElementById('password').value;
        if(!n || !p) return alert("Введите ник и пароль!");

        // Проверка на админа
        if(n === ADM_N) {
            if(p === ADM_P) {
                sessionStorage.setItem('isAdmin', 'true');
                loginExecute(n, true);
            } else {
                alert("Неверный пароль администратора!");
            }
            return;
        }

        // Проверка игрока
        let u = users.find(x => x.nick.toLowerCase() === n.toLowerCase());
        
        if(u) {
            if(u.pass !== p) {
                alert("Этот ник занят! Введите верный пароль.");
                return;
            }
        } else {
            // Регистрация
            u = { nick: n, pass: p, msg: "", result: "" };
            users.push(u);
            save();
        }

        sessionStorage.setItem('isAdmin', 'false');
        loginExecute(n, false);
    }

    function loginExecute(n, isAdmin) {
        sessionStorage.setItem('logged', n);
        document.getElementById('loginSec').classList.add('hidden');
        document.getElementById('topNav').classList.remove('hidden');
        document.getElementById('userLabel').innerText = n;

        if(isAdmin) {
            document.getElementById('adminNavBtn').classList.remove('hidden');
            showSection('adminSec');
        } else {
            const u = users.find(x => x.nick === n);
            updateProfileUI(u);
            showSection('profileSec');
        }
    }

    function showSection(id) {
        document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
        if(id === 'adminSec') renderAdmin();
        checkAlert();
    }

    function updateProfileUI(u) {
        if(!u) return;
        if(u.msg || u.result) {
            document.getElementById('reqForm').classList.add('hidden');
            document.getElementById('reqOk').classList.remove('hidden');
            const info = document.getElementById('statusInfo');
            if(u.result) {
                info.innerText = "ОТВЕТ АДМИНА: " + u.result;
                info.style.color = u.result === "ОДОБРЕНО" ? "green" : "red";
            } else {
                info.innerText = "Сообщение доставлено! Ожидайте.";
                info.style.color = "green";
            }
        } else {
            document.getElementById('reqForm').classList.remove('hidden');
            document.getElementById('reqOk').classList.add('hidden');
        }
    }

    function sendToAdmin() {
        const n = sessionStorage.getItem('logged');
        const t = document.getElementById('requestText').value.trim();
        if(!t) return;
        users = users.map(u => u.nick === n ? {...u, msg: t, result: ""} : u);
        save();
        updateProfileUI(users.find(x => x.nick === n));
        checkAlert();
    }

    function renderAdmin() {
        const l = document.getElementById('requestList');
        const list = users.filter(x => x.msg);
        l.innerHTML = list.length ? list.map(x => `
            <div class="req-card">
                <b>${x.nick}</b>: ${x.msg}<br><br>
                <button class="mc-button" onclick="decide('${x.nick}', 'ОДОБРЕНО')">ОДОБРИТЬ</button>
                <button class="mc-button" style="background:#800" onclick="decide('${x.nick}', 'ОТКАЗАНО')">ОТКАЗАТЬ</button>
            </div>
        `).join('') : "Сообщений нет.";
        checkAlert();
    }

    function decide(n, res) {
        users = users.map(u => u.nick === n ? {...u, msg: "", result: res} : u);
        save();
        renderAdmin();
    }

    function resetRequest() {
        const n = sessionStorage.getItem('logged');
        users = users.map(u => u.nick === n ? {...u, msg: "", result: ""} : u);
        save();
        updateProfileUI(users.find(x => x.nick === n));
    }

    function checkAlert() {
        const pending = users.some(u => u.msg);
        const mark = document.getElementById('adminAlert');
        if(mark) mark.classList.toggle('hidden', !pending);
    }

    function logout() { sessionStorage.clear(); location.reload(); }
    function save() { localStorage.setItem('lunex_v60_pass', JSON.stringify(users)); }
</script>
</body>
</html>